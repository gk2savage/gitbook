# Scanning and Enumeration

### To Find Hosts in the Network

netdiscover  
arp-scan -l  
ping 10.10.10.0/24  
nmap -sn 10.10.10.0/24  
fping 10.10.10.10

### NMAP

`nmap -T4 -p- -A  10.10.10.10`

`nmap -sC -sV -Pn 10.10.10.10 | tee a.nmap`

### RUSTSCAN

`rustscan -a 10.10.10.10`

### MASSCAN

`masscan -p1-65535 --rate 1000 192.168.1.1` 

### **NESSUS**

![](../.gitbook/assets/image.png)

## DNS Enumeration

### **Banner Grabbing**

DNS does not have a "banner" to grab. The closest equivalent is a magic query for `version.bind. CHAOS TXT` which will work on most BIND nameservers.  
You can perform this query using `dig`:

```bash
dig version.bind CHAOS TXT @DNS
```

If that does not work you can use fingerprinting techniques to determine the remote server's version -- the [`fpdns`](https://github.com/kirei/fpdns) tool is one option for that, but there are others.

You can grab the banner also with a **nmap** script:

```text
--script dns-nsid
```

### **Zone Transfer**

```bash
dig axfr @<DNS_IP> #Try zone transfer without domain
dig axfr @<DNS_IP> <DOMAIN> #Try zone transfer guessing the domain
fierce -dns <DOMAIN> #Will try toperform a zone transfer against every authoritative name server and if this doesn'twork, will launch a dictionary attack
```

### More info

```bash
dig ANY @<DNS_IP> <DOMAIN>     #Any information
dig A @<DNS_IP> <DOMAIN>       #Regular DNS request
dig AAAA @<DNS_IP> <DOMAIN>    #IPv6 DNS request
dig TXT @<DNS_IP> <DOMAIN>     #Information
dig MX @<DNS_IP> <DOMAIN>      #Emails related
dig NS @<DNS_IP> <DOMAIN>      #DNS that resolves that name
dig -x 192.168.0.2 @<DNS_IP>   #Reverse lookup
dig -x 2a00:1450:400c:c06::93 @<DNS_IP> #reverse IPv6 lookup

#Use [-p PORT]  or  -6 (to use ivp6 address of dns)
```

#### Using nslookup

```bash
nslookup
> SERVER <IP_DNS> #Select dns server
> 127.0.0.1 #Reverse lookup of 127.0.0.1, maybe...
> <IP_MACHINE> #Reverse lookup of a machine, maybe...
```

### Useful Metasploit modules

```bash
auxiliary/gather/enum_dns #Perform enumeration actions
```

